<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="es">
<title>Estimating the amplification efficiency of qPCR • es</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the amplification efficiency of qPCR">
<meta property="og:description" content="es">
<meta property="og:image" content="https://gilesjohnr.github.io/es/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQPXKPQH2C"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HQPXKPQH2C');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">es</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/template_es_data.html">1. Data templates</a>
    <a class="dropdown-item" href="../articles/metadata_functions.html">2. Metadata</a>
    <a class="dropdown-item" href="../articles/derivative_quantities.html">3. qPCR absolute quantification</a>
    <a class="dropdown-item" href="../articles/derivative_quantities.html">4. qPCR relative quantification</a>
    <a class="dropdown-item" href="../articles/amplification_efficiency.html">5. qPCR amplification efficiency</a>
    <a class="dropdown-item" href="../articles/get_climate_data.html">6. Climate data</a>
    <a class="dropdown-item" href="../articles/calc_hydro_variables.html">7. Hydrological variables</a>
    <a class="dropdown-item" href="../articles/calc_local_population.html">8. Local population</a>
    <a class="dropdown-item" href="../articles/get_admin_data.html">9. Administrative boundaries</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gilesjohnr/es" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimating the amplification efficiency of qPCR</h1>
            
      
      
      <div class="d-none name"><code>amplification_efficiency.Rmd</code></div>
    </div>

    
    
<p>Adjusting qPCR data according based on amplification efficiency is an
important step for estimating pathogen presence accurately and reliably.
Amplification efficiency refers to how effectively a PCR reaction
duplicates the target nucleic acid in each each cycle (see Thermo
Fisher’s <a href="https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html" class="external-link">Efficiency
of Real-Time PCR</a>). If an efficiency of 100% is reached, then the
quantity of the target will double with each cycle. However, variations
in the PCR reactions due to reagents or template quality can degrade
efficiency <span class="citation">(<a href="#ref-stolovitzky1996">Stolovitzky and Cecchi 1996</a>)</span>. It
is also likely that when performing environmental sampling, there will
be additional inhibitors for the environment in the sample that may
cause further inefficiency of the PCR reaction. Therefore, it is
important to quantify and account for these inefficiencies because they
can lead to significant inaccuracies in the quantification of gene
expression levels and subsequent detection of pathogens.</p>
<div class="section level2">
<h2 id="estimation-of-amplification-efficiency-using-the-standard-curve-method">Estimation of amplification efficiency using the standard curve
method<a class="anchor" aria-label="anchor" href="#estimation-of-amplification-efficiency-using-the-standard-curve-method"></a>
</h2>
<p>We have included two functions
(<code><a href="../reference/est_amplification_efficiency.html">est_amplification_efficiency()</a></code> and
<code><a href="../reference/apply_amplification_efficiency.html">apply_amplification_efficiency()</a></code>) to assist in efficiency
calculations. These functions use the standard curve method to estimate
the percentile amplification efficiency for each target in the provided
standard curve data <span class="citation">(<a href="#ref-yuan2008">Yuan, Wang, and Stewart 2008</a>; <a href="#ref-yuan2006">Yuan et al. 2006</a>)</span>. Note that data must
be in the standardized format described in the
<code>template_standard_curve</code> data object. To estimate the
percentile amplification efficiency <span class="math inline">\(\phi\)</span>, we fit the following linear model
to get the slope <span class="math inline">\(\beta_{\text{efficiency}}\)</span>:</p>
<p><span class="math display">\[\text{Ct}_{ij} = \alpha +
\beta_{\text{efficiency}} \text{log}_2\big(S_{ij}\big) +
\epsilon.\]</span></p>
<p>Where, <span class="math inline">\(S_{ij}\)</span> is the serial
diluted concentration of the target nucleic acid for observation <span class="math inline">\(i\)</span> and gene target <span class="math inline">\(j\)</span>, and the percentile amplification
efficiency is <span class="math inline">\(\phi =
-\beta_{\text{efficiency}}\)</span>. Assuming that the standard curve
assay contains greater than 5 observations and target concentrations
double with each serial dilution, we expect that <span class="math inline">\(\phi = 1\)</span> in the case of perfect
efficiency and <span class="math inline">\(\phi &lt; 1\)</span>
otherwise.</p>
<center>
<img src="../reference/figures/plot_efficiency.png" style="width:50.0%">
</center>
<p>The following code will estimate <span class="math inline">\(\phi\)</span> and its 95% confidence intervals for
a single target using <code><a href="../reference/est_amplification_efficiency.html">est_amplification_efficiency()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>sel <span class="ot">&lt;-</span> template_standard_curve<span class="sc">$</span>target_name <span class="sc">==</span> <span class="st">'target_1'</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>tmp_n_copies <span class="ot">&lt;-</span> template_standard_curve<span class="sc">$</span>n_copies[sel]</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>tmp_ct_value <span class="ot">&lt;-</span> template_standard_curve<span class="sc">$</span>ct_value[sel]</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">est_amplification_efficiency</span>(<span class="at">n_copies =</span> tmp_n_copies,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                             <span class="at">ct_value =</span> tmp_ct_value)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="sc">$</span>mean</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.956834</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="sc">$</span>ci_lo</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">1.409495</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="sc">$</span>ci_hi</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>[<span class="dv">1</span>] <span class="fl">0.5041726</span></span></code></pre></div>
<p>And <code><a href="../reference/apply_amplification_efficiency.html">apply_amplification_efficiency()</a></code> will apply the same
function to all gene targets within a data frame following the format of
the <code>template_standard_curve</code> data object:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">apply_amplification_efficiency</span>(template_standard_curve)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  target_name     mean    ci_lo     ci_hi</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="dv">1</span>    target_0 <span class="fl">1.098055</span> <span class="fl">1.461838</span> <span class="fl">0.7342719</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="dv">2</span>    target_1 <span class="fl">0.956834</span> <span class="fl">1.409495</span> <span class="fl">0.5041726</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="dv">3</span>    target_2 <span class="fl">1.280836</span> <span class="fl">1.886246</span> <span class="fl">0.6754255</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="dv">4</span>    target_3 <span class="fl">1.099861</span> <span class="fl">1.562983</span> <span class="fl">0.6367384</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-stolovitzky1996" class="csl-entry">
Stolovitzky, G., and G. Cecchi. 1996. <span>“Efficiency of DNA
replication in the polymerase chain reaction.”</span> <em>Proceedings of
the National Academy of Sciences of the United States of America</em> 93
(23): 12947–52. <a href="https://doi.org/10.1073/pnas.93.23.12947" class="external-link">https://doi.org/10.1073/pnas.93.23.12947</a>.
</div>
<div id="ref-thermofisherscientific2024" class="csl-entry">
Thermo Fisher Scientific. 2024. <span>“Efficiency of Real-Time
PCR.”</span> <a href="https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html" class="external-link">https://www.thermofisher.com/us/en/home/life-science/pcr/real-time-pcr/real-time-pcr-learning-center/real-time-pcr-basics/efficiency-real-time-pcr-qpcr.html</a>.
</div>
<div id="ref-yuan2006" class="csl-entry">
Yuan, Joshua S., Ann Reed, Feng Chen, and C Neal Stewart. 2006.
<span>“Statistical Analysis of Real-Time PCR Data.”</span> <em>BMC
Bioinformatics</em> 7 (1): 85. <a href="https://doi.org/10.1186/1471-2105-7-85" class="external-link">https://doi.org/10.1186/1471-2105-7-85</a>.
</div>
<div id="ref-yuan2008" class="csl-entry">
Yuan, Joshua S., Donglin Wang, and C. Neal Stewart. 2008.
<span>“Statistical Methods for Efficiency Adjusted
Real<span>-</span>Time PCR Quantification.”</span> <em>Biotechnology
Journal</em> 3 (1): 112–23. <a href="https://doi.org/10.1002/biot.200700169" class="external-link">https://doi.org/10.1002/biot.200700169</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John R Giles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
