<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="es">
<title>Getting administrative units of sampling sites â€¢ es</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting administrative units of sampling sites">
<meta property="og:description" content="es">
<meta property="og:image" content="https://gilesjohnr.github.io/es/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-HQPXKPQH2C"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HQPXKPQH2C');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">es</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/template_es_data.html">1. Data templates</a>
    <a class="dropdown-item" href="../articles/metadata_functions.html">2. Metadata</a>
    <a class="dropdown-item" href="../articles/derivative_quantities.html">3. qPCR absolute quantification</a>
    <a class="dropdown-item" href="../articles/derivative_quantities.html">4. qPCR relative quantification</a>
    <a class="dropdown-item" href="../articles/amplification_efficiency.html">5. qPCR amplification efficiency</a>
    <a class="dropdown-item" href="../articles/get_climate_data.html">6. Climate data</a>
    <a class="dropdown-item" href="../articles/calc_hydro_variables.html">7. Hydrological variables</a>
    <a class="dropdown-item" href="../articles/calc_local_population.html">8. Local population</a>
    <a class="dropdown-item" href="../articles/get_admin_data.html">9. Administrative boundaries</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">News</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gilesjohnr/es" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Getting administrative units of sampling sites</h1>
            
      
      
      <div class="d-none name"><code>get_admin_data.Rmd</code></div>
    </div>

    
    
<p>Environmental Sampling (ES) studies are conducted in a variety of
settings, ranging from densely urban to suburban and rural areas. One
aspect of collating a thorough set of metadata for ES observations
includes reverse geocoding, which converts the latitude and longitude of
sampling sites into place names. This process facilitates the grouping
of sites, weighting of observations, and relating collected samples to
the local population. To support this, we have implemented a set of
functions that identify ISO3 codes, download administrative boundaries
via the <a href="https://www.geoboundaries.org/" class="external-link">geoBoundaries API</a>,
and retrieve all administrative levels related to each set of
coordinates in an ES dataset.</p>
<p>See below for an example of how to use the <code>es</code> package to
download geographic boundaries and identify the administrative units for
a set of sampling sites.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Create an output directory</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="fu">getwd</span>(), <span class="st">'tmp'</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">dir.create</span>(path)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="co"># Get ISO3 code for sample data</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>template_iso <span class="ot">&lt;-</span> <span class="fu">coords_to_iso3</span>(<span class="at">lon=</span>template_es_data<span class="sc">$</span>lon,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                               <span class="at">lat=</span>template_es_data<span class="sc">$</span>lat)</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="co"># Download administrative unit data from geoBoundaries</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="fu">download_admin_data</span>(<span class="at">iso3 =</span> template_iso<span class="sc">$</span>admin_0_iso[<span class="dv">1</span>], </span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                    <span class="at">release=</span><span class="st">'gbOpen'</span>, </span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                    <span class="at">path_output =</span> path, </span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>                    <span class="at">keep_geojson =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>                    <span class="at">simplified =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>trying URL <span class="st">'https://github.com/wmgeolab/geoBoundaries/raw/9469f09/releaseData/gbOpen/BGD/ADM4/geoBoundaries-BGD-ADM4_simplified.geojson'</span></span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>Content type <span class="st">'application/octet-stream'</span> length <span class="dv">12493127</span> <span class="fu">bytes</span> (<span class="fl">11.9</span> MB)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a><span class="sc">==</span><span class="er">================================================</span></span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>downloaded <span class="fl">11.9</span> MB</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>trying URL <span class="st">'https://github.com/wmgeolab/geoBoundaries/raw/9469f09/releaseData/gbOpen/BGD/ADM3/geoBoundaries-BGD-ADM3_simplified.geojson'</span></span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>Content type <span class="st">'application/octet-stream'</span> length <span class="dv">3986002</span> <span class="fu">bytes</span> (<span class="fl">3.8</span> MB)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="sc">==</span><span class="er">================================================</span></span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>downloaded <span class="fl">3.8</span> MB</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>trying URL <span class="st">'https://github.com/wmgeolab/geoBoundaries/raw/9469f09/releaseData/gbOpen/BGD/ADM2/geoBoundaries-BGD-ADM2_simplified.geojson'</span></span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>Content type <span class="st">'application/octet-stream'</span> length <span class="dv">1686112</span> <span class="fu">bytes</span> (<span class="fl">1.6</span> MB)</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a><span class="sc">==</span><span class="er">================================================</span></span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>downloaded <span class="fl">1.6</span> MB</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a></span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>trying URL <span class="st">'https://github.com/wmgeolab/geoBoundaries/raw/9469f09/releaseData/gbOpen/BGD/ADM1/geoBoundaries-BGD-ADM1_simplified.geojson'</span></span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>Content type <span class="st">'application/octet-stream'</span> length <span class="dv">92247</span> <span class="fu">bytes</span> (<span class="dv">90</span> KB)</span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a><span class="sc">==</span><span class="er">================================================</span></span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>downloaded <span class="dv">90</span> KB</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" tabindex="-1"></a>trying URL <span class="st">'https://github.com/wmgeolab/geoBoundaries/raw/9469f09/releaseData/gbOpen/BGD/ADM0/geoBoundaries-BGD-ADM0_simplified.geojson'</span></span>
<span id="cb1-37"><a href="#cb1-37" tabindex="-1"></a>Content type <span class="st">'application/octet-stream'</span> length <span class="dv">57643</span> <span class="fu">bytes</span> (<span class="dv">56</span> KB)</span>
<span id="cb1-38"><a href="#cb1-38" tabindex="-1"></a><span class="sc">==</span><span class="er">================================================</span></span>
<span id="cb1-39"><a href="#cb1-39" tabindex="-1"></a>downloaded <span class="dv">56</span> KB</span>
<span id="cb1-40"><a href="#cb1-40" tabindex="-1"></a></span>
<span id="cb1-41"><a href="#cb1-41" tabindex="-1"></a>Done.</span>
<span id="cb1-42"><a href="#cb1-42" tabindex="-1"></a>Data saved here<span class="sc">:</span> <span class="er">&lt;</span>working directory<span class="sc">&gt;</span><span class="er">/</span>tmp<span class="sc">/</span>BGD_admin_levels_simplified.shp</span></code></pre></div>
<p>Administrative units from geoBoundaries are downloaded to the â€˜tmpâ€™
directory. Individual GeoJSON files for each administrative level are
downloaded first, and then a composite ESRI Shapefile is saved to the
output directory.</p>
<p><img src="../reference/figures/dir_admin_units.png" style="width:90.0%"></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Relate downloaded administrative data to sampling sites</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">get_admin_data</span>(<span class="at">lon =</span> template_es_data<span class="sc">$</span>lon,</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>               <span class="at">lat =</span> template_es_data<span class="sc">$</span>lat,</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>               <span class="at">path_admin_data =</span> <span class="fu">file.path</span>(path, <span class="st">'BGD_admin_levels_simplified.shp'</span>))</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>Loading admin data...</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>Extracting admin info at point locations...</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>Done.</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  id   lon   lat    admin_0 admin_1 admin_2 admin_3           admin_4 iso3</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="dv">1</span>  <span class="dv">1</span> <span class="fl">90.37</span> <span class="fl">23.80</span> Bangledesh   Dhaka   Dhaka Pallabi Ward No<span class="dv">-14</span> (part)  BGD</span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="dv">2</span>  <span class="dv">2</span> <span class="fl">90.38</span> <span class="fl">23.80</span> Bangledesh   Dhaka   Dhaka  Kafrul        Ward No<span class="dv">-16</span>  BGD</span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="dv">3</span>  <span class="dv">3</span> <span class="fl">90.37</span> <span class="fl">23.81</span> Bangledesh   Dhaka   Dhaka Pallabi        Ward No<span class="dv">-03</span>  BGD</span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>             geometry</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="dv">1</span>  <span class="fu">POINT</span> (<span class="fl">90.37</span> <span class="fl">23.8</span>)</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="dv">2</span>  <span class="fu">POINT</span> (<span class="fl">90.38</span> <span class="fl">23.8</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="dv">3</span> <span class="fu">POINT</span> (<span class="fl">90.37</span> <span class="fl">23.81</span>)</span></code></pre></div>
<p>And the following plotting code will visualize the sampling sites and
associated administrative units.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapefile_path</span> <span class="op">&lt;-</span> <span class="st">"&lt;working directory&gt;/tmp/BGD_admin_levels_simplified.shp"</span></span>
<span><span class="va">shapefile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">shapefile_path</span><span class="op">)</span></span>
<span></span>
<span><span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">template_es_data</span><span class="op">$</span><span class="va">lon</span>, y <span class="op">=</span> <span class="va">template_es_data</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span></span>
<span><span class="va">coordinates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">coordinates</span><span class="op">)</span></span>
<span><span class="va">points_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">coordinates</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">shapefile</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">shapefile2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_join</a></span><span class="op">(</span><span class="va">shapefile</span>, <span class="va">points_sf</span>, join <span class="op">=</span> <span class="va">st_contains</span>, left<span class="op">=</span><span class="cn">F</span><span class="op">)</span></span>
<span><span class="va">points_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_join.html" class="external-link">st_join</a></span><span class="op">(</span><span class="va">points_sf</span>, <span class="va">shapefile</span>, join <span class="op">=</span> <span class="va">st_within</span><span class="op">)</span></span>
<span><span class="va">bbox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_bbox.html" class="external-link">st_bbox</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_buffer</a></span><span class="op">(</span><span class="va">points_sf</span>, dist <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">shapefile</span>, fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">points_sf</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">admin_4</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Shapefile with administrative level 4"</span>,</span>
<span>          x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>          y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">shapefile</span>, fill <span class="op">=</span> <span class="st">"white"</span>, color <span class="op">=</span> <span class="st">"grey"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">shapefile2</span>, <span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">admin_4</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">geom_sf</span><span class="op">(</span>data <span class="op">=</span> <span class="va">points_sf</span>, <span class="fu">aes</span><span class="op">(</span>color <span class="op">=</span> <span class="va">admin_4</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">coord_sf</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">[</span><span class="st">"xmin"</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="st">"xmax"</span><span class="op">]</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bbox</span><span class="op">[</span><span class="st">"ymin"</span><span class="op">]</span>, <span class="va">bbox</span><span class="op">[</span><span class="st">"ymax"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">scale_fill_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">scale_color_brewer</span><span class="op">(</span>palette <span class="op">=</span> <span class="st">"Set1"</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">guides</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Administrative Unit"</span><span class="op">)</span>,</span>
<span>            color <span class="op">=</span> <span class="fu">guide_legend</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Administrative Unit"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>     <span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Administrative place name of each site"</span>,</span>
<span>          x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>          y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>          color <span class="op">=</span> <span class="st">"Polygon"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">leg</span> <span class="op">&lt;-</span> <span class="fu">get_legend</span><span class="op">(</span><span class="va">p2</span><span class="op">)</span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'none'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_grid</span><span class="op">(</span></span>
<span>     <span class="fu">plot_grid</span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol<span class="op">=</span><span class="fl">2</span>, align <span class="op">=</span> <span class="st">'vh'</span><span class="op">)</span>,</span>
<span>     <span class="va">leg</span>,</span>
<span>     rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.2</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<center>
<img src="../reference/figures/plot_admin_units.png" style="width:100.0%">
</center>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John R Giles.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
